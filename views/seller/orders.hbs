<div class="container p-4">
  <h2 class="mb-4">Orders</h2>

  {{#if message}}
    <div class="alert alert-{{message.type}} alert-dismissible fade show" role="alert">
      {{message.content}}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {{/if}}

  {{#if orders.length}}
    <table class="table table-bordered table-hover">
      <thead class="table-primary">
        <tr>
          <th>#</th>
          <th>User</th>
          <th>Shipping Address</th>
          <th>Products</th>
          <th>Total Amount</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {{#each orders}}
          <tr>
            <td>{{addOne @index}}</td>
            <td>{{user.name}} ({{user.email}})</td>
            <td>{{shippingAddress}}</td>
            <td>
              <ul>
                {{#each products}}
                  <li>{{product.name}} × {{quantity}}</li>
                {{/each}}
              </ul>
            </td>
            <td>{{totalAmount}}</td>
            <td>{{status}}</td>
            <td>
              <form action="/seller/update-order/{{_id}}" method="POST" style="display:inline;">
                <input type="hidden" name="status" value="Accepted">
                <button class="btn btn-sm btn-success mb-1" type="submit">Accept</button>
              </form>
              <form action="/seller/update-order/{{_id}}" method="POST" style="display:inline;">
                <input type="hidden" name="status" value="Shipped">
                <button class="btn btn-sm btn-primary mb-1" type="submit">Shipped</button>
              </form>
              <form action="/seller/update-order/{{_id}}" method="POST" style="display:inline;">
                <input type="hidden" name="status" value="Cancelled">
                <button class="btn btn-sm btn-danger mb-1" type="submit">Reject</button>
          <div class="container p-4">
  <h2 class="mb-4">Orders</h2>

  {{#if message}}
    <div class="alert alert-{{message.type}} alert-dismissible fade show" role="alert">
      {{message.content}}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {{/if}}

  {{#if orders.length}}
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle text-center">
        <thead class="table-primary">
          <tr>
            <th>#</th>
            <th>User</th>
            <th>Shipping Address</th>
            <th>Products</th>
            <th>Total Amount</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {{#each orders}}
          <tr>
            <td>{{addOne @index}}</td>
            <td>{{user.name}} <br><small>{{user.email}}</small></td>
            <td>{{shippingAddress}}</td>
            <td>
              <ul class="list-unstyled mb-0">
                {{#each products}}
                  <li>{{product.name}} × {{quantity}}</li>
                {{/each}}
              </ul>
            </td>
            <td>${{totalAmount}}</td>
            <td>
              <span class="badge 
                {{#if (eq status 'Ordered')}}bg-warning
                {{else if (eq status 'Accepted')}}bg-success
                {{else if (eq status 'Shipped')}}bg-primary
                {{else if (eq status 'Near Hub')}}bg-info
                {{else if (eq status 'Delivered')}}bg-dark
                {{else if (eq status 'Cancelled')}}bg-danger
                {{/if}}">
                {{status}}
              </span>
            </td>
            <td>
              <form action="/seller/update-order/{{_id}}" method="POST" style="display:inline;">
                <input type="hidden" name="status" value="Accepted">
                <button class="btn btn-sm btn-success mb-1" type="submit">Accept</button>
              </form>
              <form action="/seller/update-order/{{_id}}" method="POST" style="display:inline;">
                <input type="hidden" name="status" value="Shipped">
                <button class="btn btn-sm btn-primary mb-1" type="submit">Shipped</button>
              </form>
              <form action="/seller/update-order/{{_id}}" method="POST" style="display:inline;">
                <input type="hidden" name="status" value="Cancelled">
                <button class="btn btn-sm btn-danger mb-1" type="submit">Reject</button>
              </form>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
  {{else}}
    <p class="text-muted">No orders yet.</p>
  {{/if}}
</div>

<!-- Bootstrap CSS & JS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<style>
/* Table styling */
.table-hover tbody tr:hover {
  background-color: #f1f5f9;
  transition: 0.3s;
}

.table td, .table th {
  vertical-align: middle;
}

/* Badge colors override (optional) */
.badge {
  font-size: 0.9rem;
}

/* Buttons spacing */
.btn-sm {
  min-width: 70px;
}

/* Responsive fix for smaller screens */
@media (max-width: 768px) {
  .table-responsive {
    overflow-x: auto;
  }
  .btn-sm {
    min-width: 60px;
    font-size: 0.75rem;
  }
}
</style>
    </form>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  {{else}}
    <p class="text-muted">No orders yet.</p>
  {{/if}}
</div>
